<!doctype html>
<html lang="uk">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–í–∞–ª–µ–Ω—Ç–∏–Ω–∫–∞ ‚ù§Ô∏è</title>

  <style>
    :root{
      --bg1:#06060a; --bg2:#0b0820;
      --text:#f6f3ff; --muted:rgba(246,243,255,.75);
      --stroke:rgba(255,255,255,.14);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
      background:
        radial-gradient(1200px 700px at 20% 10%, #2a0f3a 0%, transparent 55%),
        radial-gradient(900px 600px at 90% 30%, #121b5c 0%, transparent 55%),
        linear-gradient(180deg, var(--bg1), var(--bg2));
    }
    .wrap{
      min-height:100%;
      display:grid; place-items:center;
      padding:22px; gap:10px; text-align:center;
    }
    .badge{
      padding:6px 12px;
      border:1px solid var(--stroke);
      background:rgba(255,255,255,.04);
      border-radius:999px;
      font-size:12px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--muted);
    }
    h1{margin:6px 0 0; font-size:clamp(26px,3.6vw,44px)}
    .sub{margin:0 0 12px; color:var(--muted)}

    .card{
      width:min(860px, 94vw);
      background:linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.03));
      border:1px solid var(--stroke);
      border-radius:24px;
      padding:16px;
      display:grid; gap:12px;
      box-shadow:0 18px 70px rgba(0,0,0,.55);
    }
    .stage{
      width:100%;
      height:min(560px, 66vh);
      border-radius:18px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.10);
      overflow:hidden;
      position:relative;
    }
    canvas{ position:absolute; inset:0; width:100%; height:100%; display:block; }

    .btn{
      justify-self:center;
      cursor:pointer;
      border:none;
      padding:12px 16px;
      border-radius:14px;
      color:var(--text);
      background:linear-gradient(90deg, rgba(255,122,217,.86), rgba(126,105,255,.86));
      box-shadow: 0 12px 40px rgba(255,122,217,.18);
      font-weight:700;
    }

    .msg{
      text-align:left;
      padding:16px;
      border-radius:18px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(0,0,0,.18);
    }
    .hidden{display:none}
    .sig{margin-top:10px; opacity:.75; font-style:italic}
  </style>
</head>

<body>
  <main class="wrap">
    <div class="badge">üíå –í–ê–õ–ï–ù–¢–ò–ù–ö–ê</div>
    <h1>–Ø —Ç–µ–±–µ –ª—é–±–ª—é</h1>
    <p class="sub">–ù–∞—Ç–∏—Å–Ω–∏ —Å–µ—Ä–¥–µ—á–∫–æ ‚ú®</p>

    <section class="card">
      <div class="stage" aria-label="heart canvas">
        <canvas id="c"></canvas>
      </div>

      <button id="btn" class="btn">–í—ñ–¥–∫—Ä–∏—Ç–∏ –ø–æ—Å–ª–∞–Ω–Ω—è</button>

      <div id="msg" class="msg hidden">
        <h2>–ú–æ—î –ø–æ—Å–ª–∞–Ω–Ω—è –¥–ª—è —Ç–µ–±–µ</h2>
        <p>
          –¢–∏ ‚Äî –º–æ—è –Ω–∞–π—Ç–µ–ø–ª—ñ—à–∞ –ª—é–¥–∏–Ω–∞. –î—è–∫—É—é, —â–æ —Ç–∏ —î. ‚ù§Ô∏è<br/>
          –•–æ—á—É —â–µ –±–∞–≥–∞—Ç–æ-–±–∞–≥–∞—Ç–æ –Ω–∞—à–∏—Ö –¥–Ω—ñ–≤ —Ä–∞–∑–æ–º.
        </p>
        <div class="sig">‚Äî –¢–≤–æ—è –ù—ñ–∫–∞</div>
      </div>
    </section>
  </main>

  <script>
    // ========= message toggle =========
    const btn = document.getElementById("btn");
    const msg = document.getElementById("msg");
    btn.addEventListener("click", () => {
      msg.classList.toggle("hidden");
      btn.textContent = msg.classList.contains("hidden") ? "–í—ñ–¥–∫—Ä–∏—Ç–∏ –ø–æ—Å–ª–∞–Ω–Ω—è" : "–°—Ö–æ–≤–∞—Ç–∏ –ø–æ—Å–ª–∞–Ω–Ω—è";
    });

    // ========= Heart (JS port of your Tkinter code) =========
    const canvas = document.getElementById("c");
    const ctx = canvas.getContext("2d", { alpha: true });

    // ‚Äî‚Äî‚Äî‚Äî‚Äî config (–º–æ–∂–µ—à –º—ñ–Ω—è—Ç–∏) ‚Äî‚Äî‚Äî‚Äî‚Äî
    const HEART_COLOR = "#f76070";
    const FPS = 60;                   // –ø–ª–∞–≤–Ω—ñ—à–µ –Ω—ñ–∂ 160ms —É tkinter
    const GENERATE_FRAMES = 20;        // —è–∫ —É Python
    const BASE_POINTS = 2000;          // —è–∫ —É Python
    const EDGE_DIFFUSE_MULT = 3;       // —è–∫ —É Python (3 —Ä–∞–∑–∏)
    const CENTER_DIFFUSE_POINTS = 4000;
    const ENLARGE_BASE = 11;           // IMAGE_ENLARGE
    const ENLARGE_HALO = 11.6;

    // resize + DPR
    function resize(){
      const r = canvas.getBoundingClientRect();
      const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1));
      canvas.width  = Math.floor(r.width * dpr);
      canvas.height = Math.floor(r.height * dpr);
      ctx.setTransform(dpr,0,0,dpr,0,0);

      state.w = r.width;
      state.h = r.height;
      state.cx = r.width/2;
      state.cy = r.height/2;
    }
    window.addEventListener("resize", resize);

    // helpers
    const rand = (a=0,b=1)=> a + Math.random()*(b-a);
    const randi = (a,b)=> (a + Math.floor(Math.random()*(b-a+1)));
    const clamp = (v,min,max)=> Math.max(min, Math.min(max, v));

    function heartFunction(t, shrinkRatio){
      let x = 16 * Math.pow(Math.sin(t), 3);
      let y = -(13 * Math.cos(t) - 5 * Math.cos(2*t) - 2 * Math.cos(3*t) - Math.cos(4*t));
      x *= shrinkRatio;
      y *= shrinkRatio;
      x += state.cx;
      y += state.cy;
      return {x, y};
    }

    function scatterInside(x,y,beta=0.15){
      const ratioX = -beta * Math.log(Math.random());
      const ratioY = -beta * Math.log(Math.random());
      const dx = ratioX * (x - state.cx);
      const dy = ratioY * (y - state.cy);
      return { x: x - dx, y: y - dy };
    }

    function shrink(x,y,ratio){
      const dx0 = x - state.cx, dy0 = y - state.cy;
      const force = -1 / Math.pow((dx0*dx0 + dy0*dy0), 0.6);
      const dx = ratio * force * dx0;
      const dy = ratio * force * dy0;
      return { x: x - dx, y: y - dy };
    }

    function curve(p){
      return 2 * (2 * Math.sin(4*p)) / (2*Math.PI);
    }

    function calcPosition(x,y,ratio){
      const dx0 = x - state.cx, dy0 = y - state.cy;
      const force = 1 / Math.pow((dx0*dx0 + dy0*dy0), 0.520); // –º–∞–≥—ñ—á–Ω–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä
      const dx = ratio * force * dx0 + randi(-1,1);
      const dy = ratio * force * dy0 + randi(-1,1);
      return { x: x - dx, y: y - dy };
    }

    const state = {
      w: 0, h: 0, cx: 0, cy: 0,
      frames: [],
      frame: 0,
      // interaction: click to "burst"
      burst: 0
    };

    // build heart points (sets)
    function buildHeart(){
      // base points
      const points = [];
      for(let i=0;i<BASE_POINTS;i++){
        const t = rand(0, Math.PI*2);
        const p = heartFunction(t, ENLARGE_BASE);
        points.push(p);
      }

      // edge diffusion
      const edge = [];
      for(const p of points){
        for(let k=0;k<EDGE_DIFFUSE_MULT;k++){
          const q = scatterInside(p.x, p.y, 0.05);
          edge.push(q);
        }
      }

      // center diffusion
      const center = [];
      for(let i=0;i<CENTER_DIFFUSE_POINTS;i++){
        const p = points[randi(0, points.length-1)];
        const q = scatterInside(p.x, p.y, 0.17);
        center.push(q);
      }

      return { points, edge, center };
    }

    function precomputeFrames(base){
      const frames = new Array(GENERATE_FRAMES);

      for(let f=0; f<GENERATE_FRAMES; f++){
        const ratio = 10 * curve((f/10)*Math.PI);

        const haloRadius = Math.floor(4 + 6*(1 + curve((f/10)*Math.PI)));
        const haloNumber = Math.floor(3000 + 4000*Math.abs(Math.pow(curve((f/10)*Math.PI), 2)));

        const all = [];

        // halo points (unique-ish)
        const seen = new Set();
        for(let i=0; i<haloNumber; i++){
          const t = rand(0, Math.PI*2);
          let p = heartFunction(t, ENLARGE_HALO);
          p = shrink(p.x, p.y, haloRadius);

          const key = ((p.x|0) << 16) ^ (p.y|0);
          if(seen.has(key)) continue;
          seen.add(key);

          const x = p.x + randi(-14,14);
          const y = p.y + randi(-14,14);
          const size = [1,2,2][randi(0,2)];
          all.push({x,y,size, layer:"halo"});
        }

        for(const p of base.points){
          const q = calcPosition(p.x,p.y,ratio);
          all.push({x:q.x,y:q.y,size:randi(1,3), layer:"core"});
        }
        for(const p of base.edge){
          const q = calcPosition(p.x,p.y,ratio);
          all.push({x:q.x,y:q.y,size:randi(1,2), layer:"edge"});
        }
        for(const p of base.center){
          const q = calcPosition(p.x,p.y,ratio);
          all.push({x:q.x,y:q.y,size:randi(1,2), layer:"center"});
        }

        frames[f] = all;
      }

      return frames;
    }

    // draw
    function draw(){
      // clear
      ctx.clearRect(0,0,state.w,state.h);

      // black-ish base inside card
      // (–ª–µ–≥–∫–∏–π –∑–∞—Ç–µ–º–Ω—é–≤–∞—á –¥–ª—è –∫–æ–Ω—Ç—Ä–∞—Å—Ç—É)
      ctx.fillStyle = "rgba(0,0,0,0.18)";
      ctx.fillRect(0,0,state.w,state.h);

      const pts = state.frames[state.frame % GENERATE_FRAMES];

      // glow pass (–º'—è–∫–µ —Å–≤—ñ—Ç—ñ–Ω–Ω—è)
      ctx.save();
      ctx.globalCompositeOperation = "lighter";
      ctx.shadowColor = "rgba(255,120,170,0.55)";
      ctx.shadowBlur = 16;

      for(const p of pts){
        // –Ω—ñ–∂–Ω–∏–π –≥—Ä–∞–¥—ñ—î–Ω—Ç: halo —Å–≤—ñ—Ç–ª—ñ—à–∏–π, —Ü–µ–Ω—Ç—Ä –Ω–∞—Å–∏—á–µ–Ω—ñ—à–∏–π
        let alpha = 0.95;
        if(p.layer === "halo") alpha = 0.45;
        if(p.layer === "center") alpha = 0.85;

        // burst –ø—Ä–∏ –∫–ª—ñ–∫—É
        const extra = state.burst > 0 ? (0.18 * state.burst) : 0;
        alpha = clamp(alpha + extra, 0, 1);

        ctx.fillStyle = hexToRgba(HEART_COLOR, alpha);
        ctx.fillRect(p.x, p.y, p.size, p.size);
      }
      ctx.restore();

      // crisp pass
      ctx.save();
      ctx.shadowBlur = 0;
      for(const p of pts){
        let alpha = 0.9;
        if(p.layer === "halo") alpha = 0.35;
        ctx.fillStyle = hexToRgba(HEART_COLOR, alpha);
        ctx.fillRect(p.x, p.y, p.size, p.size);
      }
      ctx.restore();

      // decay burst
      state.burst = Math.max(0, state.burst - 0.05);

      state.frame++;
    }

    function hexToRgba(hex, a){
      const h = hex.replace("#","");
      const r = parseInt(h.substring(0,2),16);
      const g = parseInt(h.substring(2,4),16);
      const b = parseInt(h.substring(4,6),16);
      return `rgba(${r},${g},${b},${a})`;
    }

    // click interaction
    canvas.addEventListener("pointerdown", () => {
      state.burst = 1;
    });

    // init
    function init(){
      resize();
      const base = buildHeart();
      state.frames = precomputeFrames(base);

      // animate loop
      let last = 0;
      const frameTime = 1000 / FPS;

      function loop(ts){
        if(ts - last >= frameTime){
          draw();
          last = ts;
        }
        requestAnimationFrame(loop);
      }
      requestAnimationFrame(loop);
    }

    // —Å—Ç–∞—Ä—Ç
    init();
  </script>
</body>
</html>
